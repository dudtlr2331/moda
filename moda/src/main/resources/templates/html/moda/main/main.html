<!DOCTYPE html>
<html>
<head>
    <title>moda</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
<div class="logo">
    <img src="/images/logo.png" alt="로고 이미지">
</div>

<div class="login-text">
    <div th:if="${uId}">
        <span th:text="${uId} + '님 환영합니다.'" id="hello_user"></span>
        <input th:onclick="'location.href=\'/moda/logout\''" id="logout_btn" type="image" class="w70" alt="Submit" width="20" height="20" src="/images/icon_logout.png"/>
        <input th:if="${uAdmin == '1'}" id="admin_btn" onclick="openAdminPage()" type="image" class="w70" alt="Submit" width="25" height="25" src="/images/icon_adm.png">
    </div>
    <div th:if="${uId == null}">
        <input th:onclick="'location.href=\'/moda/login.do\''" type="image" class="w70" id="login_btn" alt="Submit" width="20" height="20" src="/images/icon_login.jpg"/>
    </div>
</div>


<!-- 가로 메뉴 -->
<ul class="horizontal-menu">
    <li><a href="#">신상</a></li>
    <li><a href="#">베스트</a></li>
    <li><a href="#">카테고리</a></li>
    <li><a href="#">장바구니</a></li>
    <li><a href="#">마이페이지</a></li>
</ul>

<!-- 슬라이더 컨테이너 -->
<div class="slider-container">
    <div class="slider">
        <div class="slide">
            <img src="/images/event1.jpg" alt="이미지 1">
        </div>
        <div class="slide">
            <img src="/images/event2.jpg" alt="이미지 2">
        </div>
        <div class="slide">
            <img src="/images/event3.jpg" alt="이미지 3">
        </div>
    </div>
    <button class="slider-button slider-button-prev" onclick="moveSlide(-1)">◄</button>
    <button class="slider-button slider-button-next" onclick="moveSlide(1)">►</button>
</div>
<p class="recommendation-text">오늘의 추천</p>

<!-- Thymeleaf 반복문을 이용하여 이미지를 동적으로 추가 -->
<div th:if="${mainHomeList != null and #lists.size(mainHomeList) gt 0}" class="img_area">
    <div th:each="item : ${mainHomeList}">
        <img th:src="${item.prodImg} + ${item.prodImgDtl}">
        <div class="txt_area">
            <div class="item_name" th:text="${item.prodName}"></div>
            <div class="item_price">
                <span class="color_red" th:text="${#numbers.formatInteger(item.prodPrice, 0, 'COMMA')} + '원'"></span>
            </div>
        </div>
        <div class="dim"></div>
    </div>
</div>
<div th:if="${mainHomeList == null or #lists.size(mainHomeList) == 0}">
    <div class="img_a">데이터가 없습니다.</div>
</div>

<!-- JavaScript 코드 추가 -->
<script>
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const slideCount = slides.length;

    //뒤로가기 못하게 하는 로직
    window.history.pushState(null, "", window.location.href);
    window.onpopstate = function() {
        window.history.pushState(null, "", window.location.href);
    };

    //관리자 페이지를 새탭에서 열기
    function openAdminPage() {
        window.open('/adm/product/prodList.do', '_blank');
    }

    function showSlide(n) {
        slides.forEach(slide => slide.style.display = 'none');
        slides[n].style.display = 'block';
    }

    function moveSlide(n) {
        currentSlide = (currentSlide + n + slideCount) % slideCount;
        showSlide(currentSlide);
    }

    showSlide(currentSlide);
    document.querySelector('.slider-button-prev').addEventListener('click', () => moveSlide(-1));
    document.querySelector('.slider-button-next').addEventListener('click', () => moveSlide(1));
</script>
</body>
</html>